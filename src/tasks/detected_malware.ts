import { Task } from "graphile-worker";

export interface DetectedMalware {
    rule_id: number;
    strings_matched: [{
        source: string;
        string_offset: number;
        string_identifier: string;
        string_data: string;
    }];
}

const task: Task = async (inPayload, { addJob, withPgClient }) => {
    const payload: DetectedMalware = inPayload as any;

    console.log('Sending notifications for detected malware');
    console.log(payload);

};

export default task;
